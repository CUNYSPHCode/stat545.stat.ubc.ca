---
title: "List Columns"
output: html_document
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>Did you know that a column of a tibble can contain a list – not just a vector? This week explores when such a thing would come in handy, and how to work with list columns.</p>
<p>From this topic, students are anticipated to be able to:</p>
<ul>
<li>Use the <code>map</code> family of functions from the purrr package to iteratively apply a function.</li>
<li>Create and operate on list columns in a tibble using <code>nest()</code>, <code>unnest()</code>, and the <code>map()</code> family of functions.</li>
<li>Define functions on-the-fly within a <code>map</code> function using shortcuts.</li>
<li>Apply list columns to cases in data analysis: columns of models, columns of nested lists (JSON-style data), and operating on entire groups within a tibble.</li>
</ul>
<div id="resources" class="section level2">
<h2>Resources</h2>
<p>Video lectures:</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=nJgrDoCENBI">Vectors and Lists in R</a></li>
<li><a href="https://www.youtube.com/watch?v=_731PZ8I9m0">R List Columns: purrr map and nesting</a></li>
</ul>
<p>Written material:</p>
<ul>
<li><a href="https://r4ds.had.co.nz/iteration.html">R4DS Chapter 21: Iteration</a> for purrr
<ul>
<li>21.1 for an intro</li>
<li>21.5 for the <code>map</code> family of functions</li>
<li>The intro of 21.7 for the <code>map2</code> and <code>pmap</code> families.</li>
</ul></li>
<li><a href="https://jennybc.github.io/purrr-tutorial/ls13_list-columns.html">“List Columns”</a> from <a href="https://jennybc.github.io/purrr-tutorial/index.html">Jenny’s purrr tutorial</a></li>
<li><a href="https://tidyr.tidyverse.org/articles/nest.html">“Nested data” article</a> on tidyr’s website.</li>
</ul>
<p>Want to dig deeper? These resources can help.</p>
<ul>
<li><a href="https://adv-r.hadley.nz/functionals.html">Advanced R Chapter 9: Functionals</a> – looking at purrr and <code>map()</code> from a programming perspective.</li>
<li><a href="https://tidyr.tidyverse.org/articles/rectangle.html">tidyr’s rectangling vignette</a> – for handling deeply nested lists (JSON-style data), similar to tidyr’s <code>pivot_</code> functions.</li>
</ul>
</div>
<div id="test-your-understanding" class="section level2">
<h2>Test Your Understanding</h2>
<ol style="list-style-type: decimal">
<li>True or False: <code>map(1:3, ~ function(x) x ^ 2)</code> returns the list <code>list(1, 4, 9)</code>.</li>
<li>You write a function <code>square()</code> that squares its input – but the first thing it does is print a message to the screen! True or False: <code>map_dbl(1:10, square)</code> will throw an error, because the output is not a <code>dbl</code> (a number) – it contains the message, too.</li>
<li>True or False: purrr-style functions, starting with <code>~</code>, can be used in dplyr’s <code>across()</code> function, such as <code>mutate(across(where(is.numeric), ~ .x ^ 2))</code>, and this function can only take one argument (<code>.x</code>)</li>
<li>True or False: If I have 10 tibbles I want to save to file, and they’re all stored in a list, the best purrr function to use for saving these to file is <code>map()</code>.</li>
<li>True or False: Just as <code>c(c(1, 2), c(3, 4))</code> returns the vector of numbers from 1 to 4, <code>list(list(1, 2), list(3, 4))</code> returns the list of numbers from 1 to 4.</li>
<li>True or False: <code>tibble(model = lm(mpg ~ wt, data = mtcars))</code> doesn’t work because it doesn’t use a <code>map</code> function.</li>
</ol>
</div>
<div id="demonstration" class="section level2">
<h2>Demonstration</h2>
<p>Why use the <code>map</code> functions over <code>for</code> loops? Aside from what’s said at <a href="https://r4ds.had.co.nz/iteration.html#for-loops-vs.-functionals">R4DS’s Section 21.4</a>, the <code>map</code> family encourages the input vector(s) and function to be carefully defined first, whereas a <code>for</code> loop is more of a free-for-all. Using <code>map()</code> is also more readable, is pipe-friendly, and jibes well with list columns in tibbles.</p>
<p>Let’s jump right into the worksheet for this topic.</p>
</div>
